# from urllib.parse import urlencode
import requests
import json
import wget
import pandas as pd
from pandas import ExcelWriter
from pandas import ExcelFile
import pypatent

df = pd.read_excel('applications.xlsx', sheetname='Sheet1')


#print(df.columns)

application_number = df['application_number'][0]
application_title = df['title'][0]

#print(application_number)
application_number="{:,}".format(application_number)

x = pypatent.Search(application_number).as_dataframe()
application = (x.ix[application_number])
print(application.index)
app_title = str((application['title']))
app_inventors = str((application['inventors']))
app_abstract = str((application['abstract']))
print(type(app_title))
print(type(app_inventors))
print(type(app_abstract))

from pptx import Presentation

prs = Presentation()
title_slide_layout = prs.slide_layouts[0]
slide = prs.slides.add_slide(title_slide_layout)
title = slide.shapes.title
subtitle = slide.placeholders[1]

title.text = app_title
subtitle.text = app_inventors

prs.save(str('{0}.pptx'.format(application_number)))
